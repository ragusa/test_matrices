clear all; close all; clc; format compact;



q=4;
n = 2^q;
A = spdiags(ones(n,1)*[-1 2 -1],-1:1,n,n);  % 1d Poisson matrix

% p = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]; % Natural
% p = [1 3 5 7 9 11 13 15 2 4 6 8 10 12 14 16]; % 2 Colors
% C = full(A(p,p));
% spy(C); title ('2 colors'); 

% p= [ 1,5,9,13,2,6,10,14,3,7,11,15,4,8,12,16 ]; % p1 - 4 colors
% p= [ 2,6,10,14,1,5,9,13,3,7,11,15,4,8,12,16 ]; % p2 - 4 colors
% p= [ 1,5,9,13,3,7,11,15,2,6,10,14,4,8,12,16 ]; % p3 - 4 colors
% p= [ 2,6,10,14,3,7,11,15,1,5,9,13,4,8,12,16 ]; % p4 - 4 colors
% p= [ 3,7,11,15,1,5,9,13,2,6,10,14,4,8,12,16 ]; % p5 - 4 colors
% p= [ 3,7,11,15,2,6,10,14,1,5,9,13,4,8,12,16 ]; % p6 - 4 colors
% p= [ 1,5,9,13,2,6,10,14,4,8,12,16,3,7,11,15 ]; % p7 - 4 colors
% p= [ 2,6,10,14,1,5,9,13,4,8,12,16,3,7,11,15 ]; % p8 - 4 colors
% p= [ 1,5,9,13,3,7,11,15,4,8,12,16,2,6,10,14 ]; % p9 - 4 colors
% p= [ 2,6,10,14,3,7,11,15,4,8,12,16,1,5,9,13 ]; % p10 - 4 colors
% p= [ 3,7,11,15,1,5,9,13,4,8,12,16,2,6,10,14 ]; % p11 - 4 colors
% p= [ 3,7,11,15,2,6,10,14,4,8,12,16,1,5,9,13 ]; % p12 - 4 colors
% p= [ 1,5,9,13,4,8,12,16,2,6,10,14,3,7,11,15 ]; % p13 - 4 colors
% p= [ 2,6,10,14,4,8,12,16,1,5,9,13,3,7,11,15 ]; % p14 - 4 colors
% p= [ 1,5,9,13,4,8,12,16,3,7,11,15,2,6,10,14 ]; % p15 - 4 colors
% p= [ 2,6,10,14,4,8,12,16,3,7,11,15,1,5,9,13 ]; % p16 - 4 colors
% p= [ 3,7,11,15,4,8,12,16,1,5,9,13,2,6,10,14 ]; % p17 - 4 colors
% p= [ 3,7,11,15,4,8,12,16,2,6,10,14,1,5,9,13 ]; % p18 - 4 colors
% p= [ 4,8,12,16,1,5,9,13,2,6,10,14,3,7,11,15 ]; % p19 - 4 colors
% p= [ 4,8,12,16,2,6,10,14,1,5,9,13,3,7,11,15 ]; % p20 - 4 colors
% p= [ 4,8,12,16,1,5,9,13,3,7,11,15,2,6,10,14 ]; % p21 - 4 colors
% p= [ 4,8,12,16,2,6,10,14,3,7,11,15,1,5,9,13 ]; % p22 - 4 colors
% p= [ 4,8,12,16,3,7,11,15,1,5,9,13,2,6,10,14 ]; % p23 - 4 colors
% p= [ 4,8,12,16,3,7,11,15,2,6,10,14,1,5,9,13 ]; % p24 - 4 colors
C = full(A (p,p));
% spy(C); title ('4 colors'); 


    
% p = [2,10,4,12,6,14,8,16,1,9,3,11,5,13,7,15];
% C = full(A(p,p));
% spy(C); title ('6 colors'); 

H11 = C(1:n/2,1:n/2);
H12 = C(n/2+1:n,1:n/2);
H21 = C(n/2+1:n,1:n/2);
H22 = C(n/2+1:n,n/2+1:n);

B = H22-H21*inv(H11)*H12;

subplot(1,2,1); do_spy (C); title ('PAP^T');
subplot(1,2,2); do_spy (B); title ('After elimination'); 
